<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®åˆ†æ - Dify çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f5f7fa;
            color: #1f2937;
            line-height: 1.6;
        }

        .header {
            background: #fff;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .back-btn {
            padding: 8px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 18px;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #111827;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .container {
            max-width: 1400px;
            margin: 24px auto;
            padding: 0 24px;
        }

        .date-range-selector {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .date-range-buttons {
            display: flex;
            gap: 8px;
        }

        .date-btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .date-btn:hover {
            background: #f3f4f6;
        }

        .date-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .custom-date-range {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .date-input {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        .export-btn {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .stat-title {
            font-size: 14px;
            color: #6b7280;
        }

        .stat-icon {
            font-size: 20px;
            color: #6b7280;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .stat-change {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .change-up {
            color: #10b981;
        }

        .change-down {
            color: #ef4444;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1300px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
        }

        .chart-actions {
            display: flex;
            gap: 8px;
        }

        .chart-container {
            height: 300px;
            position: relative;
        }

        .chart-placeholder {
            background: #f9fafb;
            border: 1px dashed #e5e7eb;
            border-radius: 6px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 14px;
        }

        .table-card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
        }

        .analytics-table {
            width: 100%;
            border-collapse: collapse;
        }

        .analytics-table th {
            text-align: left;
            padding: 12px 16px;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-size: 13px;
            font-weight: 600;
            color: #374151;
        }

        .analytics-table td {
            padding: 16px;
            border-bottom: 1px solid #f3f4f6;
        }

        .analytics-table tr:hover {
            background: #f9fafb;
        }

        .query-text {
            font-weight: 500;
            color: #111827;
        }

        .query-count {
            text-align: center;
        }

        .accuracy-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .accuracy-high {
            background: #d1fae5;
            color: #065f46;
        }

        .accuracy-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .accuracy-low {
            background: #fee2e2;
            color: #991b1b;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-name {
            font-weight: 500;
            color: #111827;
        }

        .user-role {
            font-size: 13px;
            color: #6b7280;
        }

        .knowledge-base-badge {
            display: inline-block;
            padding: 4px 8px;
            background: #eff6ff;
            color: #1e40af;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .filter-bar {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            font-weight: 500;
            color: #374151;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            min-width: 160px;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .insight-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .insight-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .insight-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: #eff6ff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #3b82f6;
        }

        .insight-title {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
        }

        .insight-content {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }

        .insight-action {
            margin-top: 16px;
            font-size: 14px;
            color: #3b82f6;
            cursor: pointer;
        }

        .insight-action:hover {
            text-decoration: underline;
        }

        .tech-section {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .tech-section h2 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #111827;
        }

        .tech-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #f3f4f6;
        }

        .tech-item:last-child {
            border-bottom: none;
        }

        .tech-item h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }

        .tech-item p {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }

        .tech-item ul {
            margin-left: 20px;
            margin-top: 8px;
        }

        .tech-item li {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .code-block {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 12px;
            margin-top: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #374151;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <button class="back-btn" onclick="location.href='index.html'">â†</button>
            <h1>æ•°æ®åˆ†æ</h1>
        </div>
        <div class="header-actions">
            <button class="btn btn-secondary export-btn" onclick="exportData()">
                ğŸ“Š å¯¼å‡ºæŠ¥å‘Š
            </button>
            <button class="btn btn-primary" onclick="refreshData()">
                ğŸ”„ åˆ·æ–°æ•°æ®
            </button>
        </div>
    </div>

    <div class="container">
        <div class="date-range-selector">
            <div class="date-range-buttons">
                <button class="date-btn active" onclick="setDateRange('today')">ä»Šå¤©</button>
                <button class="date-btn" onclick="setDateRange('yesterday')">æ˜¨å¤©</button>
                <button class="date-btn" onclick="setDateRange('week')">æœ€è¿‘7å¤©</button>
                <button class="date-btn" onclick="setDateRange('month')">æœ€è¿‘30å¤©</button>
                <button class="date-btn" onclick="setDateRange('quarter')">æœ€è¿‘90å¤©</button>
            </div>
            <div class="custom-date-range">
                <input type="date" class="date-input" id="startDate" value="2024-01-01">
                <span>è‡³</span>
                <input type="date" class="date-input" id="endDate" value="2024-01-20">
                <button class="btn btn-secondary" onclick="applyCustomDateRange()">åº”ç”¨</button>
            </div>
        </div>

        <div class="filter-bar">
            <div class="filter-group">
                <div class="filter-label">çŸ¥è¯†åº“</div>
                <select class="filter-select" id="knowledgeBaseFilter">
                    <option value="all">å…¨éƒ¨çŸ¥è¯†åº“</option>
                    <option value="product">äº§å“æ–‡æ¡£åº“</option>
                    <option value="tech">æŠ€æœ¯çŸ¥è¯†åº“</option>
                    <option value="support">å®¢æˆ·æ”¯æŒåº“</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">ç”¨æˆ·</div>
                <select class="filter-select" id="userFilter">
                    <option value="all">å…¨éƒ¨ç”¨æˆ·</option>
                    <option value="admin">ç®¡ç†å‘˜</option>
                    <option value="editor">ç¼–è¾‘è€…</option>
                    <option value="viewer">æŸ¥çœ‹è€…</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">æ£€ç´¢ç±»å‹</div>
                <select class="filter-select" id="searchTypeFilter">
                    <option value="all">å…¨éƒ¨ç±»å‹</option>
                    <option value="semantic">è¯­ä¹‰æ£€ç´¢</option>
                    <option value="keyword">å…³é”®è¯æ£€ç´¢</option>
                    <option value="hybrid">æ··åˆæ£€ç´¢</option>
                </select>
            </div>
            <div class="filter-group">
                <div class="filter-label">æ’åºæ–¹å¼</div>
                <select class="filter-select" id="sortFilter">
                    <option value="count">æŒ‰è°ƒç”¨æ¬¡æ•°</option>
                    <option value="time">æŒ‰å“åº”æ—¶é—´</option>
                    <option value="accuracy">æŒ‰å‡†ç¡®ç‡</option>
                </select>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">æ€»æ£€ç´¢æ¬¡æ•°</div>
                    <div class="stat-icon">ğŸ”</div>
                </div>
                <div class="stat-value">12,345</div>
                <div class="stat-change change-up">
                    â†‘ 15% è¾ƒä¸Šå‘¨
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">å¹³å‡å“åº”æ—¶é—´</div>
                    <div class="stat-icon">â±ï¸</div>
                </div>
                <div class="stat-value">156ms</div>
                <div class="stat-change change-down">
                    â†“ 8% è¾ƒä¸Šå‘¨
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">æ£€ç´¢å‡†ç¡®ç‡</div>
                    <div class="stat-icon">ğŸ¯</div>
                </div>
                <div class="stat-value">92.3%</div>
                <div class="stat-change change-up">
                    â†‘ 2.1% è¾ƒä¸Šå‘¨
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">æ´»è·ƒç”¨æˆ·æ•°</div>
                    <div class="stat-icon">ğŸ‘¥</div>
                </div>
                <div class="stat-value">156</div>
                <div class="stat-change change-up">
                    â†‘ 23% è¾ƒä¸Šå‘¨
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">æ£€ç´¢é‡è¶‹åŠ¿</div>
                    <div class="chart-actions">
                        <button class="btn-icon" title="æ—¥è§†å›¾">ğŸ“…</button>
                        <button class="btn-icon" title="å‘¨è§†å›¾">ğŸ“†</button>
                        <button class="btn-icon" title="æœˆè§†å›¾">ğŸ—“ï¸</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        æ£€ç´¢é‡è¶‹åŠ¿å›¾è¡¨ï¼ˆä½¿ç”¨ Chart.js æˆ– EChartsï¼‰
                        <br>
                        Xè½´ï¼šæ—¶é—´ï¼ŒYè½´ï¼šæ£€ç´¢æ¬¡æ•°
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">æ£€ç´¢æ¥æºåˆ†å¸ƒ</div>
                    <div class="chart-actions">
                        <button class="btn-icon" title="é¥¼å›¾">ğŸ¥§</button>
                        <button class="btn-icon" title="ç¯å½¢å›¾">â­•</button>
                        <button class="btn-icon" title="æ¡å½¢å›¾">ğŸ“Š</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        æ£€ç´¢æ¥æºåˆ†å¸ƒå›¾è¡¨
                        <br>
                        å±•ç¤ºä¸åŒçŸ¥è¯†åº“çš„æ£€ç´¢æ¯”ä¾‹
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">å“åº”æ—¶é—´åˆ†å¸ƒ</div>
                    <div class="chart-actions">
                        <button class="btn-icon" title="ç›´æ–¹å›¾">ğŸ“ˆ</button>
                        <button class="btn-icon" title="ç®±çº¿å›¾">ğŸ“¦</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        å“åº”æ—¶é—´åˆ†å¸ƒå›¾è¡¨
                        <br>
                        å±•ç¤ºä¸åŒå“åº”æ—¶é—´åŒºé—´çš„è¯·æ±‚æ•°é‡
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">ç”¨æˆ·æ´»è·ƒæ—¶æ®µ</div>
                    <div class="chart-actions">
                        <button class="btn-icon" title="çƒ­åŠ›å›¾">ğŸ”¥</button>
                        <button class="btn-icon" title="æŠ˜çº¿å›¾">ğŸ“ˆ</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        ç”¨æˆ·æ´»è·ƒæ—¶æ®µçƒ­åŠ›å›¾
                        <br>
                        å±•ç¤ºä¸€å¤©ä¸­ä¸åŒæ—¶æ®µçš„ç”¨æˆ·æ´»è·ƒåº¦
                    </div>
                </div>
            </div>
        </div>

        <div class="insights-grid">
            <div class="insight-card">
                <div class="insight-header">
                    <div class="insight-icon">ğŸ’¡</div>
                    <div class="insight-title">æ€§èƒ½ä¼˜åŒ–å»ºè®®</div>
                </div>
                <div class="insight-content">
                    æ£€ç´¢å“åº”æ—¶é—´åœ¨é«˜å³°æ—¶æ®µï¼ˆ10:00-12:00ï¼‰å¢åŠ äº†15%ï¼Œå»ºè®®ï¼š
                    <br>â€¢ ä¼˜åŒ–å‘é‡æ•°æ®åº“ç´¢å¼•
                    <br>â€¢ å¢åŠ ç¼“å­˜ç­–ç•¥
                    <br>â€¢ è€ƒè™‘è´Ÿè½½å‡è¡¡
                </div>
                <div class="insight-action" onclick="viewPerformanceDetails()">æŸ¥çœ‹è¯¦ç»†å»ºè®® â†’</div>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <div class="insight-icon">ğŸ“ˆ</div>
                    <div class="insight-title">çƒ­é—¨å†…å®¹è¶‹åŠ¿</div>
                </div>
                <div class="insight-content">
                    æœ¬å‘¨çƒ­é—¨æŸ¥è¯¢ä¸»é¢˜ï¼š
                    <br>â€¢ API ä½¿ç”¨æ–‡æ¡£ï¼ˆæœç´¢é‡ +32%ï¼‰
                    <br>â€¢ é”™è¯¯å¤„ç†æŒ‡å—ï¼ˆæœç´¢é‡ +18%ï¼‰
                    <br>â€¢ éƒ¨ç½²é…ç½®ï¼ˆæœç´¢é‡ +12%ï¼‰
                </div>
                <div class="insight-action" onclick="viewContentTrends()">æŸ¥çœ‹è¶‹åŠ¿åˆ†æ â†’</div>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <div class="insight-icon">ğŸ¯</div>
                    <div class="insight-title">æ£€ç´¢è´¨é‡åˆ†æ</div>
                </div>
                <div class="insight-content">
                    æ£€ç´¢å‡†ç¡®ç‡ï¼š92.3%ï¼ˆè¾ƒä¸Šå‘¨ +2.1%ï¼‰
                    <br>ä½å‡†ç¡®ç‡æŸ¥è¯¢ä¸»è¦é›†ä¸­åœ¨ï¼š
                    <br>â€¢ æŠ€æœ¯æœ¯è¯­ï¼ˆå‡†ç¡®ç‡ 78%ï¼‰
                    <br>â€¢ å¤šè¯­è¨€æ··åˆæŸ¥è¯¢ï¼ˆå‡†ç¡®ç‡ 82%ï¼‰
                </div>
                <div class="insight-action" onclick="viewQualityAnalysis()">æŸ¥çœ‹è¯¦ç»†åˆ†æ â†’</div>
            </div>
        </div>

        <div class="table-card">
            <div class="table-header">
                <div class="table-title">çƒ­é—¨æŸ¥è¯¢ Top 10</div>
                <div class="chart-actions">
                    <button class="btn-icon" title="åˆ·æ–°">ğŸ”„</button>
                    <button class="btn-icon" title="å¯¼å‡º">ğŸ“¥</button>
                </div>
            </div>
            <table class="analytics-table">
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>æŸ¥è¯¢å†…å®¹</th>
                        <th>æ£€ç´¢æ¬¡æ•°</th>
                        <th>å¹³å‡å“åº”æ—¶é—´</th>
                        <th>ç”¨æˆ·æ»¡æ„åº¦</th>
                        <th>çŸ¥è¯†åº“</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>
                            <div class="query-text">å¦‚ä½•ä½¿ç”¨APIæ¥å£ï¼Ÿ</div>
                            <div style="font-size: 12px; color: #6b7280;">äº§å“æ–‡æ¡£åº“</div>
                        </td>
                        <td class="query-count">856</td>
                        <td>128ms</td>
                        <td><span class="accuracy-badge accuracy-high">94%</span></td>
                        <td><span class="knowledge-base-badge">äº§å“æ–‡æ¡£åº“</span></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>
                            <div class="query-text">é”™è¯¯ä»£ç 401è§£å†³æ–¹æ³•</div>
                            <div style="font-size: 12px; color: #6b7280;">æŠ€æœ¯çŸ¥è¯†åº“</div>
                        </td>
                        <td class="query-count">623</td>
                        <td>142ms</td>
                        <td><span class="accuracy-badge accuracy-high">92%</span></td>
                        <td><span class="knowledge-base-badge">æŠ€æœ¯çŸ¥è¯†åº“</span></td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>
                            <div class="query-text">éƒ¨ç½²é…ç½®è¦æ±‚</div>
                            <div style="font-size: 12px; color: #6b7280;">äº§å“æ–‡æ¡£åº“</div>
                        </td>
                        <td class="query-count">512</td>
                        <td>156ms</td>
                        <td><span class="accuracy-badge accuracy-medium">85%</span></td>
                        <td><span class="knowledge-base-badge">äº§å“æ–‡æ¡£åº“</span></td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>
                            <div class="query-text">æ•°æ®åº“è¿æ¥å¤±è´¥</div>
                            <div style="font-size: 12px; color: #6b7280;">å®¢æˆ·æ”¯æŒåº“</div>
                        </td>
                        <td class="query-count">487</td>
                        <td>189ms</td>
                        <td><span class="accuracy-badge accuracy-high">91%</span></td>
                        <td><span class="knowledge-base-badge">å®¢æˆ·æ”¯æŒåº“</span></td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>
                            <div class="query-text">ç”¨æˆ·æƒé™ç®¡ç†</div>
                            <div style="font-size: 12px; color: #6b7280;">äº§å“æ–‡æ¡£åº“</div>
                        </td>
                        <td class="query-count">432</td>
                        <td>134ms</td>
                        <td><span class="accuracy-badge accuracy-high">93%</span></td>
                        <td><span class="knowledge-base-badge">äº§å“æ–‡æ¡£åº“</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="table-card">
            <div class="table-header">
                <div class="table-title">æ´»è·ƒç”¨æˆ· Top 10</div>
                <div class="chart-actions">
                    <button class="btn-icon" title="åˆ·æ–°">ğŸ”„</button>
                    <button class="btn-icon" title="å¯¼å‡º">ğŸ“¥</button>
                </div>
            </div>
            <table class="analytics-table">
                <thead>
                    <tr>
                        <th>ç”¨æˆ·</th>
                        <th>æ£€ç´¢æ¬¡æ•°</th>
                        <th>æ–‡æ¡£ä¸Šä¼ </th>
                        <th>çŸ¥è¯†åº“åˆ›å»º</th>
                        <th>æ´»è·ƒåº¦</th>
                        <th>æœ€åæ´»è·ƒ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">å¼ </div>
                                <div>
                                    <div class="user-name">å¼ ä¸‰</div>
                                    <div class="user-role">ç®¡ç†å‘˜</div>
                                </div>
                            </div>
                        </td>
                        <td>1,234</td>
                        <td>45</td>
                        <td>8</td>
                        <td><span class="accuracy-badge accuracy-high">éå¸¸é«˜</span></td>
                        <td>2024-01-20 15:30</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">æ</div>
                                <div>
                                    <div class="user-name">æå››</div>
                                    <div class="user-role">ç¼–è¾‘è€…</div>
                                </div>
                            </div>
                        </td>
                        <td>987</td>
                        <td>32</td>
                        <td>5</td>
                        <td><span class="accuracy-badge accuracy-high">é«˜</span></td>
                        <td>2024-01-20 14:15</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">ç‹</div>
                                <div>
                                    <div class="user-name">ç‹äº”</div>
                                    <div class="user-role">æŸ¥çœ‹è€…</div>
                                </div>
                            </div>
                        </td>
                        <td>765</td>
                        <td>12</td>
                        <td>2</td>
                        <td><span class="accuracy-badge accuracy-medium">ä¸­</span></td>
                        <td>2024-01-20 13:45</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">èµµ</div>
                                <div>
                                    <div class="user-name">èµµå…­</div>
                                    <div class="user-role">ç¼–è¾‘è€…</div>
                                </div>
                            </div>
                        </td>
                        <td>654</td>
                        <td>28</td>
                        <td>4</td>
                        <td><span class="accuracy-badge accuracy-high">é«˜</span></td>
                        <td>2024-01-20 12:20</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">åˆ˜</div>
                                <div>
                                    <div class="user-name">åˆ˜ä¸ƒ</div>
                                    <div class="user-role">æŸ¥çœ‹è€…</div>
                                </div>
                            </div>
                        </td>
                        <td>543</td>
                        <td>8</td>
                        <td>1</td>
                        <td><span class="accuracy-badge accuracy-medium">ä¸­</span></td>
                        <td>2024-01-20 11:30</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="tech-section">
            <h2>ğŸ“‹ åŠŸèƒ½è¯´æ˜ä¸æŠ€æœ¯å®ç°</h2>

            <div class="tech-item">
                <h3>1. æ•°æ®é‡‡é›†ä¸èšåˆ</h3>
                <p><strong>åŠŸèƒ½æè¿°ï¼š</strong>æ”¶é›†ç³»ç»Ÿä½¿ç”¨æ•°æ®å¹¶è¿›è¡Œèšåˆåˆ†æã€‚</p>
                <p><strong>å‰ç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>å®æ—¶æ•°æ®æ›´æ–°ï¼šWebSocket æ¨é€æœ€æ–°ç»Ÿè®¡æ•°æ®</li>
                    <li>æ•°æ®ç­›é€‰ï¼šå¤šç»´åº¦æ•°æ®ç­›é€‰å’Œè¿‡æ»¤</li>
                    <li>æ•°æ®å¯è§†åŒ–ï¼šä½¿ç”¨ Chart.jsã€ECharts ç­‰å›¾è¡¨åº“</li>
                    <li>äº¤äº’å¼å›¾è¡¨ï¼šæ”¯æŒç¼©æ”¾ã€æ‹–æ‹½ã€ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</li>
                    <li>æ•°æ®å¯¼å‡ºï¼šæ”¯æŒ CSVã€JSONã€PDF æ ¼å¼å¯¼å‡º</li>
                </ul>
                <p><strong>åç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>äº‹ä»¶è¿½è¸ªï¼šè®°å½•ç”¨æˆ·æ“ä½œå’Œç³»ç»Ÿäº‹ä»¶</li>
                    <li>æ•°æ®èšåˆï¼šå®æ—¶èšåˆåˆ†æä½¿ç”¨æ•°æ®</li>
                    <li>æ—¶é—´åºåˆ—æ•°æ®åº“ï¼šä½¿ç”¨ InfluxDB æˆ– TimescaleDB</li>
                    <li>æ‰¹å¤„ç†ä»»åŠ¡ï¼šå®šæœŸç”ŸæˆèšåˆæŠ¥è¡¨</li>
                    <li>æ•°æ®æ¸…ç†ï¼šè‡ªåŠ¨æ¸…ç†è¿‡æœŸåˆ†ææ•°æ®</li>
                </ul>
                <div class="code-block">
# æ•°æ®é‡‡é›†æœåŠ¡
class AnalyticsCollector:
    def __init__(self):
        self.influx_client = InfluxDBClient()
        self.kafka_producer = KafkaProducer()

    def track_search(self, user_id, query, knowledge_base_id, response_time, accuracy):
        event = {
            'event_type': 'search',
            'user_id': user_id,
            'query': query,
            'knowledge_base_id': knowledge_base_id,
            'response_time': response_time,
            'accuracy': accuracy,
            'timestamp': datetime.utcnow().isoformat()
        }

        # å­˜å‚¨åˆ°æ—¶é—´åºåˆ—æ•°æ®åº“
        self.influx_client.write_points([{
            "measurement": "search_events",
            "tags": {
                "user_id": user_id,
                "knowledge_base_id": knowledge_base_id
            },
            "fields": {
                "response_time": response_time,
                "accuracy": accuracy,
                "count": 1
            },
            "time": datetime.utcnow()
        }])

        # å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ç”¨äºå®æ—¶åˆ†æ
        self.kafka_producer.send('analytics_events', event)

    def get_search_stats(self, start_time, end_time, filters=None):
        query = f'''
        SELECT MEAN(response_time) as avg_response_time,
               COUNT(*) as search_count,
               MEAN(accuracy) as avg_accuracy
        FROM search_events
        WHERE time >= '{start_time}' AND time <= '{end_time}'
        '''

        if filters:
            for key, value in filters.items():
                query += f" AND {key} = '{value}'"

        result = self.influx_client.query(query)
        return result.raw
                </div>
            </div>

            <div class="tech-item">
                <h3>2. å®æ—¶åˆ†æä¸ç›‘æ§</h3>
                <p><strong>åŠŸèƒ½æè¿°ï¼š</strong>å®æ—¶ç›‘æ§ç³»ç»Ÿæ€§èƒ½å’Œç”¨æˆ·è¡Œä¸ºã€‚</p>
                <p><strong>å‰ç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>å®æ—¶ä»ªè¡¨æ¿ï¼šWebSocket å®æ—¶æ›´æ–°æ•°æ®</li>
                    <li>æ€§èƒ½ç›‘æ§ï¼šå®æ—¶æ˜¾ç¤ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡</li>
                    <li>å¼‚å¸¸æ£€æµ‹ï¼šè‡ªåŠ¨æ£€æµ‹å¼‚å¸¸æ¨¡å¼å¹¶å‘Šè­¦</li>
                    <li>è‡ªå®šä¹‰å‘Šè­¦ï¼šç”¨æˆ·å¯é…ç½®å‘Šè­¦è§„åˆ™</li>
                </ul>
                <p><strong>åç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>æµå¼å¤„ç†ï¼šä½¿ç”¨ Kafka æˆ– RabbitMQ å¤„ç†äº‹ä»¶æµ</li>
                    <li>å®æ—¶è®¡ç®—ï¼šä½¿ç”¨ Flink æˆ– Spark Streaming</li>
                    <li>å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼šåŸºäºç»Ÿè®¡å’Œæœºå™¨å­¦ä¹ </li>
                    <li>å‘Šè­¦ç³»ç»Ÿï¼šæ”¯æŒå¤šé€šé“å‘Šè­¦é€šçŸ¥</li>
                </ul>
                <div class="code-block">
# å®æ—¶åˆ†æå¼•æ“
class RealtimeAnalyticsEngine:
    def __init__(self):
        self.spark = SparkSession.builder \
            .appName("RealtimeAnalytics") \
            .getOrCreate()

        # å®šä¹‰æµå¼å¤„ç†
        self.stream = self.spark \
            .readStream \
            .format("kafka") \
            .option("kafka.bootstrap.servers", "localhost:9092") \
            .option("subscribe", "analytics_events") \
            .load()

    def process_search_stream(self):
        # è§£æ JSON æ•°æ®
        search_df = self.stream \
            .select(from_json(col("value").cast("string"), search_schema).alias("data")) \
            .select("data.*")

        # çª—å£èšåˆ
        windowed_counts = search_df \
            .withWatermark("timestamp", "10 minutes") \
            .groupBy(
                window(col("timestamp"), "5 minutes"),
                col("knowledge_base_id")
            ) \
            .agg(
                count("*").alias("search_count"),
                avg("response_time").alias("avg_response_time"),
                avg("accuracy").alias("avg_accuracy")
            )

        # è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆå®é™…é¡¹ç›®ä¸­å¯è¾“å‡ºåˆ°æ•°æ®åº“æˆ–æ¶ˆæ¯é˜Ÿåˆ—ï¼‰
        query = windowed_counts \
            .writeStream \
            .outputMode("complete") \
            .format("console") \
            .start()

        query.awaitTermination()
                </div>
            </div>

            <div class="tech-item">
                <h3>3. ç”¨æˆ·è¡Œä¸ºåˆ†æ</h3>
                <p><strong>åŠŸèƒ½æè¿°ï¼š</strong>åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚</p>
                <p><strong>å‰ç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>ç”¨æˆ·æ—…ç¨‹åœ°å›¾ï¼šå¯è§†åŒ–ç”¨æˆ·æ“ä½œè·¯å¾„</li>
                    <li>çƒ­åŠ›å›¾åˆ†æï¼šå±•ç¤ºé¡µé¢ç‚¹å‡»çƒ­åŒº</li>
                    <li>è½¬åŒ–ç‡åˆ†æï¼šåˆ†æç”¨æˆ·ä»»åŠ¡å®Œæˆç‡</li>
                    <li>ç•™å­˜åˆ†æï¼šåˆ†æç”¨æˆ·æ´»è·ƒåº¦å’Œç•™å­˜ç‡</li>
                </ul>
                <p><strong>åç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡ï¼šå»ºç«‹ç”¨æˆ·è¡Œä¸ºæ¨¡å‹</li>
                    <li>èšç±»åˆ†æï¼šå°†ç”¨æˆ·åˆ†ä¸ºä¸åŒç¾¤ä½“</li>
                    <li>é¢„æµ‹æ¨¡å‹ï¼šé¢„æµ‹ç”¨æˆ·æµå¤±å’Œæ´»è·ƒåº¦</li>
                    <li>A/B æµ‹è¯•ï¼šæ”¯æŒåŠŸèƒ½ A/B æµ‹è¯•</li>
                </ul>
                <div class="code-block">
# ç”¨æˆ·è¡Œä¸ºåˆ†æ
class UserBehaviorAnalyzer:
    def __init__(self):
        self.db = AnalyticsDatabase()

    def analyze_user_segments(self):
        # è·å–ç”¨æˆ·è¡Œä¸ºæ•°æ®
        user_data = self.db.get_user_behavior_data()

        # ç‰¹å¾å·¥ç¨‹
        features = self.extract_features(user_data)

        # èšç±»åˆ†æ
        from sklearn.cluster import KMeans
        kmeans = KMeans(n_clusters=5, random_state=42)
        clusters = kmeans.fit_predict(features)

        # åˆ†ææ¯ä¸ªç¾¤ä½“çš„ç‰¹å¾
        segments = {}
        for i in range(5):
            segment_users = user_data[clusters == i]
            segments[f'segment_{i}'] = {
                'size': len(segment_users),
                'avg_search_count': segment_users['search_count'].mean(),
                'avg_session_duration': segment_users['session_duration'].mean(),
                'avg_accuracy': segment_users['accuracy'].mean()
            }

        return segments

    def predict_user_churn(self, user_id):
        # è·å–ç”¨æˆ·ç‰¹å¾
        user_features = self.get_user_features(user_id)

        # ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹é¢„æµ‹
        model = self.load_churn_model()
        churn_probability = model.predict_proba([user_features])[0][1]

        return churn_probability
                </div>
            </div>

            <div class="tech-item">
                <h3>4. æ£€ç´¢æ•ˆæœåˆ†æ</h3>
                <p><strong>åŠŸèƒ½æè¿°ï¼š</strong>è¯„ä¼°æ£€ç´¢ç³»ç»Ÿæ•ˆæœï¼Œä¼˜åŒ–æ£€ç´¢ç®—æ³•ã€‚</p>
                <p><strong>å‰ç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>å‡†ç¡®ç‡åˆ†æï¼šåˆ†æä¸åŒæŸ¥è¯¢çš„æ£€ç´¢å‡†ç¡®ç‡</li>
                    <li>å“åº”æ—¶é—´åˆ†æï¼šåˆ†ææ£€ç´¢å“åº”æ—¶é—´åˆ†å¸ƒ</li>
                    <li>ç›¸å…³æ€§è¯„ä¼°ï¼šäººå·¥æ ‡æ³¨å’Œè‡ªåŠ¨è¯„ä¼°ç»“åˆ</li>
                    <li>A/B æµ‹è¯•ï¼šæ¯”è¾ƒä¸åŒæ£€ç´¢ç®—æ³•çš„æ•ˆæœ</li>
                </ul>
                <p><strong>åç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>æ£€ç´¢æ—¥å¿—åˆ†æï¼šåˆ†ææ£€ç´¢æ—¥å¿—ä¸­çš„æ¨¡å¼</li>
                    <li>ç›¸å…³æ€§è¯„ä¼°ï¼šä½¿ç”¨ NDCGã€MRR ç­‰æŒ‡æ ‡</li>
                    <li>ç®—æ³•ä¼˜åŒ–ï¼šåŸºäºåˆ†æç»“æœä¼˜åŒ–æ£€ç´¢ç®—æ³•</li>
                    <li>è‡ªåŠ¨è°ƒå‚ï¼šè‡ªåŠ¨è°ƒæ•´æ£€ç´¢å‚æ•°</li>
                </ul>
                <div class="code-block">
# æ£€ç´¢æ•ˆæœè¯„ä¼°
class SearchPerformanceEvaluator:
    def __init__(self):
        self.db = SearchLogDatabase()

    def evaluate_search_accuracy(self, start_time, end_time):
        # è·å–æ£€ç´¢æ—¥å¿—
        logs = self.db.get_search_logs(start_time, end_time)

        # è®¡ç®—å‡†ç¡®ç‡æŒ‡æ ‡
        total_searches = len(logs)
        successful_searches = len([log for log in logs if log['accuracy'] >= 0.8])

        accuracy = successful_searches / total_searches if total_searches > 0 else 0

        # åˆ†æä½å‡†ç¡®ç‡æŸ¥è¯¢
        low_accuracy_queries = [
            log for log in logs
            if log['accuracy'] < 0.7
        ]

        # æŒ‰æŸ¥è¯¢åˆ†ç»„åˆ†æ
        query_analysis = {}
        for log in logs:
            query = log['query']
            if query not in query_analysis:
                query_analysis[query] = {
                    'count': 0,
                    'total_accuracy': 0,
                    'response_times': []
                }

            query_analysis[query]['count'] += 1
            query_analysis[query]['total_accuracy'] += log['accuracy']
            query_analysis[query]['response_times'].append(log['response_time'])

        # è®¡ç®—å¹³å‡æŒ‡æ ‡
        for query, data in query_analysis.items():
            data['avg_accuracy'] = data['total_accuracy'] / data['count']
            data['avg_response_time'] = sum(data['response_times']) / len(data['response_times'])

        return {
            'overall_accuracy': accuracy,
            'total_searches': total_searches,
            'successful_searches': successful_searches,
            'low_accuracy_queries': low_accuracy_queries,
            'query_analysis': query_analysis
        }
                </div>
            </div>

            <div class="tech-item">
                <h3>5. æŠ¥è¡¨ç”Ÿæˆä¸å¯¼å‡º</h3>
                <p><strong>åŠŸèƒ½æè¿°ï¼š</strong>ç”Ÿæˆåˆ†ææŠ¥è¡¨å¹¶æ”¯æŒå¯¼å‡ºã€‚</p>
                <p><strong>å‰ç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>æŠ¥è¡¨æ¨¡æ¿ï¼šé¢„å®šä¹‰æŠ¥è¡¨æ¨¡æ¿</li>
                    <li>è‡ªå®šä¹‰æŠ¥è¡¨ï¼šç”¨æˆ·è‡ªå®šä¹‰åˆ†æç»´åº¦</li>
                    <li>å¯¼å‡ºæ ¼å¼ï¼šæ”¯æŒ PDFã€Excelã€CSV ç­‰æ ¼å¼</li>
                    <li>å®šæ—¶æŠ¥è¡¨ï¼šæ”¯æŒå®šæ—¶ç”Ÿæˆå’Œå‘é€æŠ¥è¡¨</li>
                </ul>
                <p><strong>åç«¯å®ç°ï¼š</strong></p>
                <ul>
                    <li>æŠ¥è¡¨ç”Ÿæˆå¼•æ“ï¼šåŸºäºæ¨¡æ¿ç”ŸæˆæŠ¥è¡¨</li>
                    <li>æ•°æ®å¯¼å‡ºæœåŠ¡ï¼šæ”¯æŒå¤šç§æ ¼å¼å¯¼å‡º</li>
                    <li>å¼‚æ­¥å¤„ç†ï¼šå¤§æŠ¥è¡¨å¼‚æ­¥ç”Ÿæˆ</li>
                    <li>æŠ¥è¡¨ç¼“å­˜ï¼šç¼“å­˜å¸¸ç”¨æŠ¥è¡¨æå‡æ€§èƒ½</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æ—¥æœŸèŒƒå›´é€‰æ‹©
        function setDateRange(range) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ¨¡æ‹ŸåŠ è½½æ•°æ®
            loadAnalyticsData(range);
        }

        function applyCustomDateRange() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            if (!startDate || !endDate) {
                alert('è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ');
                return;
            }

            // æ¨¡æ‹ŸåŠ è½½æ•°æ®
            loadAnalyticsData('custom', { startDate, endDate });
        }

        function loadAnalyticsData(range, customParams = null) {
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            console.log(`åŠ è½½æ•°æ®ï¼ŒèŒƒå›´ï¼š${range}`, customParams);

            // å®é™…é¡¹ç›®ä¸­è¿™é‡Œåº”è¯¥è°ƒç”¨APIè·å–æ•°æ®
            // å¹¶æ›´æ–°å›¾è¡¨å’Œæ•°æ®
        }

        // æ•°æ®å¯¼å‡º
        function exportData() {
            const format = prompt('è¯·é€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼š\n1. PDF\n2. Excel\n3. CSV', 'PDF');

            if (format) {
                alert(`å¼€å§‹å¯¼å‡º ${format} æ ¼å¼çš„æŠ¥å‘Š...\nï¼ˆå®é™…é¡¹ç›®ä¸­åº”å¼€å§‹å¼‚æ­¥å¯¼å‡ºä»»åŠ¡ï¼‰`);
            }
        }

        // åˆ·æ–°æ•°æ®
        function refreshData() {
            // é‡æ–°åŠ è½½å½“å‰é€‰ä¸­çš„æ—¥æœŸèŒƒå›´
            const activeRange = document.querySelector('.date-btn.active');
            if (activeRange) {
                loadAnalyticsData(activeRange.textContent.trim());
            } else {
                loadAnalyticsData('today');
            }

            alert('æ•°æ®å·²åˆ·æ–°');
        }

        // æŸ¥çœ‹è¯¦ç»†åˆ†æ
        function viewPerformanceDetails() {
            alert('è·³è½¬åˆ°æ€§èƒ½ä¼˜åŒ–å»ºè®®è¯¦æƒ…é¡µé¢');
        }

        function viewContentTrends() {
            alert('è·³è½¬åˆ°å†…å®¹è¶‹åŠ¿åˆ†æé¡µé¢');
        }

        function viewQualityAnalysis() {
            alert('è·³è½¬åˆ°æ£€ç´¢è´¨é‡åˆ†æé¡µé¢');
        }

        // ç­›é€‰å™¨å˜åŒ–
        document.querySelectorAll('.filter-select').forEach(select => {
            select.addEventListener('change', function() {
                // åº”ç”¨ç­›é€‰æ¡ä»¶
                applyFilters();
            });
        });

        function applyFilters() {
            const filters = {
                knowledgeBase: document.getElementById('knowledgeBaseFilter').value,
                user: document.getElementById('userFilter').value,
                searchType: document.getElementById('searchTypeFilter').value,
                sort: document.getElementById('sortFilter').value
            };

            console.log('åº”ç”¨ç­›é€‰æ¡ä»¶ï¼š', filters);

            // å®é™…é¡¹ç›®ä¸­åº”è¯¥é‡æ–°åŠ è½½æ•°æ®å¹¶æ›´æ–°å›¾è¡¨
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®é»˜è®¤æ—¥æœŸ
            const today = new Date();
            const weekAgo = new Date();
            weekAgo.setDate(today.getDate() - 7);

            document.getElementById('endDate').value = today.toISOString().split('T')[0];
            document.getElementById('startDate').value = weekAgo.toISOString().split('T')[0];

            // æ¨¡æ‹ŸåŠ è½½åˆå§‹æ•°æ®
            loadAnalyticsData('today');
        });
    </script>
</body>
</html>